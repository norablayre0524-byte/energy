---
title: "Energy"
author: "Nora Stanley"
date: "2026-02-10"
output: html_document
---
##Renewable Energy Dataset
```{r}
library(readr)
library(dplyr)
library(ggplot2)
energy<-read_csv('../../data/IRENA data.csv', skip=1)
View(energy)

energy_2<-energy%>%
  rename(country='Country/area')

high_gdp<-c("United States","Qatar","Norway","Singapore","United Arab Emirates",
            "Switzerland","Ireland","Luxembourg","Saudi Arabia","Taiwan")
low_gdp<-c("Burundi","Central Africa Republic","Liberia","Democratic Republic of Congo",
           "Mozambique","Niger","Madagascar","Malwai","Chad","Afghanistan")
energy_2$`Electricity statistics`<-
  as.numeric(gsub("-",NA,energy_2$`Electricity statistics`))
world<-energy_2%>%
  group_by(Technology,`Data Type`,`Grid connection`,Year)%>%
  summarise(`Electricity statistics`=sum(`Electricity statistics`,na.rm=TRUE),
            .groups="drop")%>%
  mutate('country'="World")
energy_2<-bind_rows(energy_2,world)

energy_groups<-energy_2%>%
  mutate(group=case_when(
    country=="World"~"World",
    country%in%high_gdp~"High GDP",
    country %in%low_gdp~"Low GDP",
    TRUE~NA_character_))%>%
  filter(!is.na(group))
energy_groups_sdg<-energy_groups%>%
  filter(Year%in% c(2012,2023))
energy_groups_sdg<-energy_groups_sdg%>%
  group_by(group,Year,Technology)%>%
  summarise(total=sum(`Electricity statistics`, na.rm=TRUE),
            .groups="drop")
energy_groups_no_total<-energy_groups_sdg%>%
  filter(!Technology%in%c("Total renewable","Total non-renewable","Total"))

ggplot(energy_groups_no_total,
       aes(x=group,
           y=total,
           fill=Technology))+
  geom_col(position="fill")+
  scale_y_continuous(labels=scales::percent)+
  facet_wrap(~Year)+
  coord_flip()

```

## Gapminder Dataset
```{r}
library(gapminder)
library(dplyr)
library(ggplot2)
data(gapminder)
gapminder%>%head
gap<-gapminder%>%
  filter(country %in% c('United States', 'China', 'France','Liberia','Ethiopia','Haiti'))%>%
  filter(year>1970)
ggplot(gap,
       aes(x=year, 
           y=lifeExp,
           color=country,
           linetype=country))+
  geom_line(size=1, alpha=0.5)+
  scale_linetype_manual(values=c("China"="solid","France"="solid","United States"="solid",
                        "Ethiopia"="dashed","Haiti"="dashed","Liberia"="dashed")) +
  labs(title = "Life Expectancy for Developed and Undeveloped Countries Over Time",
  x = "Year",
  y = "Life Expectancy")
View(gapminder)
gapminder%>%
  filter(year == 2007)%>%
   slice_min(order_by = gdpPercap, n=5)
```

##Carbon emmissions
```{r}
library(dplyr)
library(readr)
library(ggplot2)
library(plotly)
library(ggthemes)
url <-'https://nyc3.digitaloceanspaces.com/owid-public/data/co2/owid-co2-data.csv'
carbon <-
  read_csv(url) 
View(carbon)
carbon<-carbon%>%
  mutate(gdp_per_capita=gdp/population)
high_gdp<-c("United States","Qatar","Norway","Singapore","United Arab Emirates",
            "Switzerland","Ireland","Luxembourg","Saudi Arabia","Taiwan")
low_gdp<-c("Burundi","Central Africa Republic","Liberia","Democratic Republic of Congo",
           "Mozambique","Niger","Madagascar","Malwai","Chad","Afghanistan")
carbon_groups<-carbon%>%
  mutate(group=case_when(
    country=="World"~"World",
    country%in%high_gdp~"High GDP",
    country %in%low_gdp~"Low GDP",
    TRUE~NA_character_))%>%
  filter(!is.na(group))

carbon_wo_world<-carbon%>%
  filter(country!="World")
carbon_groups<-carbon_wo_world%>%
  mutate(group=case_when(
    country%in%high_gdp~"High GDP",
    country%in%low_gdp~"Low GDP",
    TRUE~"World"))
carbon_trend<-carbon_groups%>%
  group_by(year,group)%>%
  summarise(mean_temp=mean(temperature_change_from_ghg, na.rm=TRUE),
            .groups="drop")

ggplot(carbon_trend,
       aes(x=year,y=mean_temp,color=group))+
  geom_line(size=1)+
  geom_vline(xintercept=2012,
             linetype ="dashed",
             size=0.5)+
    scale_x_continuous(limits=c(1850,max(carbon_trend$year)))+
  labs(title="Average Temperature Change from Greenhouse Gas Emmissions",
       x="Year",
       y="Temperature Change",
       color="Key")

 #TEMP CHANGE FROM GHGS
```
```{r}
library(dplyr)
library(readr)
library(ggplot2)
library(plotly)
library(ggthemes)
url <-'https://nyc3.digitaloceanspaces.com/owid-public/data/co2/owid-co2-data.csv'
carbon <-
  read_csv(url)

carbon_groups<-carbon%>%
  mutate(group=case_when(
    country=="World"~"World",
    country%in%high_gdp~"High GDP",
    country %in%low_gdp~"Low GDP",
    TRUE~NA_character_))%>%
  filter(!is.na(group))

high_gdp<-c("United States","Qatar","Norway","Singapore","United Arab Emirates",
            "Switzerland","Ireland","Luxembourg","Saudi Arabia","Taiwan")
low_gdp<-c("Burundi","Central Africa Republic","Liberia","Democratic Republic of Congo",
           "Mozambique","Niger","Madagascar","Malwai","Chad","Afghanistan")
carbon_wo_world<-carbon%>%
  filter(country!="World")

carbon_groups<-carbon_wo_world%>%
  mutate(group=case_when(
    country%in%high_gdp~"High GDP",
    country%in%low_gdp~"Low GDP",
    TRUE~"World"))
carbon_trend<-carbon_groups%>%
  group_by(year,group)%>%
  summarise(mean_temp=mean(temperature_change_from_ghg, na.rm=TRUE),
            .groups="drop")

ggplot(carbon_trend,
       aes(x=year,y=mean_temp,color=group))+
  geom_line(size=1)+
  geom_vline(xintercept=2012,
             linetype ="dashed",
             size=0.5)+
    scale_x_continuous(limits=c(2000,max(carbon_trend$year)))+
  labs(title="Average Temperature Change from Greenhouse Gas Emmissions",
       x="Year",
       y="Temperature Change",
       color="Key")

```

##Levelized cost of energy
```{r}
library(readr)
url <- 'https://raw.githubusercontent.com/ericmkeen/sewanee_esus/master/02_energy_sector/levelized-cost-of-energy.csv'
econ <- read_csv(url)
econ%>%head



```


```{r}
library(ggplot2)
library(dplyr)
library(readr)
url <- 'https://raw.githubusercontent.com/ericmkeen/sewanee_esus/master/02_energy_sector/levelized-cost-of-energy.csv'
econ <- read_csv(url)
View(econ)
#cost of renewable and non-renewable sources
econ_filtered<-econ%>%
  filter(country%in% c("United States","France","Sweden","Germany","Japan","China","South Korea","United Kingdom","Netherlands","Denmark"))
            
p<-ggplot(econ_filtered,
       aes(x=year,
           y=cost,
           color=factor(source),
           text=paste("country:",country,
                      "<br>year:",year,
                      "<br>source:",source,
                      "<br>cost:",round(cost,2))))+
  geom_point()+
  geom_vline(xintercept=2012)
ggplotly(p,tooltip="text")
  

  annotate(geom='text',
           x=1990,y=0.1,
           size=3,
           label='Range of fissil fuel costs')#n breaks the line for captions on the graph if too long
```

```{r}
library(dplyr)
library(knitr)
econ%>%
  group_by(country)%>%
  summarize(cost=mean(cost, na.rm=TRUE))%>%
  kable
```


