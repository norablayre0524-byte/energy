---
title: "Energy"
author: "Nora Stanley"
date: "2026-02-10"
output: html_document
---
##Renewable Energy Dataset
```{r}
library(readr)
energy<-read_csv('../../data/IRENA data.csv', skip=1)

```

## Gapminder Dataset
```{r}
library(gapminder)
library(dplyr)
library(ggplot2)
data(gapminder)
gapminder%>%head
gap<-gapminder%>%
  filter(country %in% c('United States', 'China', 'France','Liberia','Ethiopia','Haiti'))%>%
  filter(year>1970)
ggplot(gap,
       aes(x=year, 
           y=lifeExp,
           color=country,
           linetype=country))+
  geom_line(size=1, alpha=0.5)+
  scale_linetype_manual(values=c("China"="solid","France"="solid","United States"="solid",
                        "Ethiopia"="dashed","Haiti"="dashed","Liberia"="dashed")) +
  labs(title = "Life Expectancy for Developed and Undeveloped Countries Over Time",
  x = "Year",
  y = "Life Expectancy")
View(gapminder)
gapminder%>%
  filter(year == 2007)%>%
   slice_min(order_by = gdpPercap, n=5)
```

##Carbon emmissions
```{r}
library(dplyr)
library(readr)
library(ggplot2)
library(plotly)
library(ggthemes)
url <-'https://nyc3.digitaloceanspaces.com/owid-public/data/co2/owid-co2-data.csv'
carbon <-
  read_csv(url) 
View(carbon)
carbon<-carbon%>%
  mutate(gdp_per_capita=gdp/population)
high_gdp<-c("United States","Qatar","Norway","Singapore","United Arab Emirates",
            "Switzerland","Ireland","Luxembourg","Saudi Arabia","Taiwan")
low_gdp<-c("Burundi","Central Africa Republic","Liberia","Democratic Republic of Congo",
           "Mozambique","Niger","Madagascar","Malwai","Chad","Afghanistan")
carbon_groups<-carbon%>%
  mutate(group=case_when(
    country=="World"~"World",
    country%in%high_gdp~"High GDP",
    country %in%low_gdp~"Low GDP",
    TRUE~NA_character_))%>%
  filter(!is.na(group))

carbon_trend<-carbon_groups%>%
  group_by(year,group)%>%
  summarise(
    mean_temp=mean(temperature_change_from_ghg, na.rm=TRUE),
    max_temp=max(temperature_change_from_ghg, na.rm=TRUE),
    min_temp=min(temperature_change_from_ghg, na.rm=TRUE),
    .groups="drop")
y_max<-1

ggplot()+
  geom_line(data=carbon_trend,
            aes(x=year,y=mean_temp,color=group),
            size=1.0,
            alpha=0.75)+
  scale_x_continuous(limits=c(1850,max(carbon_trend$year)))+
  labs(Title="Temperature Change from Greenhouse Gases",
       x="Year",
       y="Temperature Change",
       color="Group",
       fill="Group")
 #TEMP CHANGE FROM GHGS
```
```{r}
library(dplyr)
library(readr)
library(ggplot2)
library(plotly)
library(ggthemes)
url <-'https://nyc3.digitaloceanspaces.com/owid-public/data/co2/owid-co2-data.csv'
carbon <-
  read_csv(url)

carbon_groups<-carbon%>%
  mutate(group=case_when(
    country=="World"~"World",
    country%in%high_gdp~"High GDP",
    country %in%low_gdp~"Low GDP",
    TRUE~NA_character_))%>%
  filter(!is.na(group))

high_gdp<-c("United States","Qatar","Norway","Singapore","United Arab Emirates",
            "Switzerland","Ireland","Luxembourg","Saudi Arabia","Taiwan")
low_gdp<-c("Burundi","Central Africa Republic","Liberia","Democratic Republic of Congo",
           "Mozambique","Niger","Madagascar","Malwai","Chad","Afghanistan")

```

##Levelized cost of energy
```{r}
library(readr)
url <- 'https://raw.githubusercontent.com/ericmkeen/sewanee_esus/master/02_energy_sector/levelized-cost-of-energy.csv'
econ <- read_csv(url)
econ%>%head
View(energy)
```


```{r}
library(ggplot2)
View(econ)
ggplot(econ,
       aes(x=year,
           y=cost,
           color=source))+
  geom_point()+
  geom_hline(yintercept=0.05, lty=2)+###lty=dashed and thickness
  geom_hline(yintercept = 0.18, lty=2)+
  annotate(geom='text',
           x=1990,y=0.1,
           size=3,
           label='Range of fissil fuel costs')#n breaks the line for captions on the graph if too long
```

```{r}
library(dplyr)
library(knitr)
econ%>%
  filter(year== 2020)%>%
  group_by(source)%>%
  summarize(cost=mean(cost, na.rm=TRUE))%>%
  kable
```


